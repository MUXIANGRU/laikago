<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Xenomai: udd_memregion Struct Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="Xenomai"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Xenomai
   &#160;<span id="projectnumber">3.0.5</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,true,'search.php','Search');
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('structudd__memregion.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-attribs">Data Fields</a>  </div>
  <div class="headertitle">
<div class="title">udd_memregion Struct Reference<div class="ingroups"><a class="el" href="group__rtdm.html">RTDM</a> &raquo; <a class="el" href="group__rtdm__profiles.html">Device Profiles</a> &raquo; <a class="el" href="group__rtdm__udd.html">User-space driver core</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Data Fields</h2></td></tr>
<tr class="memitem:a4e8d0d0984917bd8c5a70c9ab9fa05ab"><td class="memItemLeft" align="right" valign="top"><a id="a4e8d0d0984917bd8c5a70c9ab9fa05ab"></a>
const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structudd__memregion.html#a4e8d0d0984917bd8c5a70c9ab9fa05ab">name</a></td></tr>
<tr class="memdesc:a4e8d0d0984917bd8c5a70c9ab9fa05ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Name of the region (informational but required) <br /></td></tr>
<tr class="separator:a4e8d0d0984917bd8c5a70c9ab9fa05ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada1ae59dc9c3e7e412b23515841c432b"><td class="memItemLeft" align="right" valign="top">unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structudd__memregion.html#ada1ae59dc9c3e7e412b23515841c432b">addr</a></td></tr>
<tr class="memdesc:ada1ae59dc9c3e7e412b23515841c432b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Start address of the region.  <a href="#ada1ae59dc9c3e7e412b23515841c432b">More...</a><br /></td></tr>
<tr class="separator:ada1ae59dc9c3e7e412b23515841c432b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af592847b0c15dcc6ccb621678911f31f"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structudd__memregion.html#af592847b0c15dcc6ccb621678911f31f">len</a></td></tr>
<tr class="memdesc:af592847b0c15dcc6ccb621678911f31f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Length (in bytes) of the region.  <a href="#af592847b0c15dcc6ccb621678911f31f">More...</a><br /></td></tr>
<tr class="separator:af592847b0c15dcc6ccb621678911f31f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c1588967681e23d15f040a3eee22d4e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structudd__memregion.html#a7c1588967681e23d15f040a3eee22d4e">type</a></td></tr>
<tr class="memdesc:a7c1588967681e23d15f040a3eee22d4e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Type of the region.  <a href="#a7c1588967681e23d15f040a3eee22d4e">More...</a><br /></td></tr>
<tr class="separator:a7c1588967681e23d15f040a3eee22d4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="anchor" id="udd_memory_region"></a>UDD memory region descriptor.</p>
<p>This descriptor defines the characteristics of a memory region declared to the UDD core by the mini-driver. All valid regions should be declared in the <a class="el" href="structudd__device.html#a07a8a1d85f094c147a600e2c3b7f5995" title="Array of memory regions defined by the device. ">udd_device.mem_regions</a>[] array, invalid/unassigned ones should bear the UDD_MEM_NONE type.</p>
<p>The UDD core exposes each region via the mmap(2) interface to the application. To this end, a companion mapper device is created automatically when registering the mini-driver.</p>
<p>The mapper device creates special files in the RTDM namespace for reaching the individual regions, which the application can open then map to its address space via the mmap(2) system call.</p>
<p>For instance, declaring a region of physical memory at index #2 of the memory region array could be done as follows:</p>
<div class="fragment"><div class="line"><span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structudd__device.html">udd_device</a> udd;</div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> foocard_pci_probe(<span class="keyword">struct</span> pci_dev *dev, <span class="keyword">const</span> <span class="keyword">struct</span> pci_device_id *<span class="keywordtype">id</span>)</div><div class="line">{</div><div class="line">     udd.<a class="code" href="structudd__device.html#a8f5d7d94ba891771a3d5dfbc308fdcad">device_name</a> = <span class="stringliteral">&quot;foocard&quot;</span>;</div><div class="line">     ...</div><div class="line">     udd.mem_regions[2].name = <span class="stringliteral">&quot;ADC&quot;</span>;</div><div class="line">     udd.mem_regions[2].addr = pci_resource_start(dev, 1);</div><div class="line">     udd.mem_regions[2].len = pci_resource_len(dev, 1);</div><div class="line">     udd.mem_regions[2].type = <a class="code" href="group__rtdm__udd.html#ga00632ad4aad373171da9fc6b7d44275e">UDD_MEM_PHYS</a>;</div><div class="line">     ...</div><div class="line">     <span class="keywordflow">return</span> <a class="code" href="group__rtdm__udd.html#gaa5bee7471396c7b182a5a2a5fb60d230">udd_register_device</a>(&amp;udd);</div><div class="line">}</div></div><!-- fragment --><p>This will make such region accessible via the mapper device using the following sequence of code, via the default -&gt;mmap() handler from the UDD core:</p>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> fd, fdm;</div><div class="line"><span class="keywordtype">void</span> *p;</div><div class="line"></div><div class="line">fd = <a class="code" href="structudd__device.html#af516c02002866b74d68c4e000b6ab37e">open</a>(<span class="stringliteral">&quot;/dev/foocard&quot;</span>, O_RDWR);</div><div class="line">fdm = <a class="code" href="structudd__device.html#af516c02002866b74d68c4e000b6ab37e">open</a>(<span class="stringliteral">&quot;/dev/foocard,mapper@2&quot;</span>, O_RDWR);</div><div class="line">p = <a class="code" href="structudd__device.html#af2ecac4980b9d0a946730015068a74de">mmap</a>(NULL, 4096, PROT_READ|PROT_WRITE, 0, fdm, 0);</div></div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>No mapper device is created unless a valid region has been declared in the <a class="el" href="structudd__device.html#a07a8a1d85f094c147a600e2c3b7f5995" title="Array of memory regions defined by the device. ">udd_device.mem_regions</a>[] array. </dd></dl>
</div><h2 class="groupheader">Field Documentation</h2>
<a id="ada1ae59dc9c3e7e412b23515841c432b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada1ae59dc9c3e7e412b23515841c432b">&#9670;&nbsp;</a></span>addr</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long udd_memregion::addr</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Start address of the region. </p>
<p>This may be a physical or virtual address, depending on the <a class="el" href="group__rtdm__udd.html#udd_memory_types">memory type</a>. </p>

</div>
</div>
<a id="af592847b0c15dcc6ccb621678911f31f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af592847b0c15dcc6ccb621678911f31f">&#9670;&nbsp;</a></span>len</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t udd_memregion::len</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Length (in bytes) of the region. </p>
<p>This value must be PAGE_SIZE aligned. </p>

</div>
</div>
<a id="a7c1588967681e23d15f040a3eee22d4e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c1588967681e23d15f040a3eee22d4e">&#9670;&nbsp;</a></span>type</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int udd_memregion::type</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Type of the region. </p>
<p>See the discussion about <a class="el" href="group__rtdm__udd.html#udd_memory_types">UDD memory types</a> for possible values. </p>

</div>
</div>
<hr/>The documentation for this struct was generated from the following file:<ul>
<li>include/cobalt/kernel/rtdm/<a class="el" href="cobalt_2kernel_2rtdm_2udd_8h_source.html">udd.h</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="structudd__memregion.html">udd_memregion</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
